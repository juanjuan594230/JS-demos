<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <script>

    const arr1 = [1,34,56,23,4,56,4,1];
    const arr2 = [1,22,57,67,34,4,78,56];
    /* 求交集 */
    /* 第一版 */
    // function section(arr1, arr2) {
    //   const section = [];
    //   if (!arr1.length) {
    //     return !arr2 ? false : arr2;
    //   }
    //   if (!arr2.length) {
    //     return !arr1 ? false : arr1;
    //   }
    //   for (let i=0, len1=arr1.length; i<len1; i++) {
    //     for (let j=0, len2=arr2.length; j<len2; j++) {
    //       if (arr1[i] === arr2[j]) {
    //         section.push(arr1[i]);
    //         break;
    //       }
    //     }
    //   }
    //   return deleteRepeat(section);
    // }

    // function deleteRepeat(arr) {
    //   const obj = {};
    //   const arrNew = [];
    //   for (let i = 0, len = arr.length; i < len; i++) {
    //     if (!obj[arr[i]]) {
    //       obj[arr[i]] = true;
    //       arrNew.push(arr[i]);
    //     }
    //   }
    //   return arrNew;
    // }
    // console.log(union(arr1, arr2));

    /* 第二版 时间复杂度仍为o(n^2)*/
    function binarySearch(arr, value) {
      if (!arr || arr.length === 0) {
        return false;
      }
      let start = 0,
          end = arr.length - 1,
          middle = -1;
      // 第二处
      while(start <= end) {
        // 第一处
        middle = Math.ceil((start + end) / 2);
        // console.log(start + ' ' + end +  ' ' + middle);
        const midValue = arr[middle];
        // 往前找
        if (midValue > value) {
          end = middle - 1;
        }
        // 往后找
        else if (midValue < value) {
          start = middle + 1;
        } 
        else {
          return true;
        }
      }
      return false;
    }
    function compare(value1, value2) {
      if (value1 > value2) {
        return 1;
      } else if (value1 < value2) {
        return -1;
      } else {
        return 0;
      }
    }
    function section(arr1, arr2) {
      const obj = {};
      const section = [];
      if (!arr1.length) {
        return !arr2 ? false : arr2;
      }
      if (!arr2.length) {
        return !arr1 ? false : arr1;
      }
      arr2.sort(compare);
      for (let i=0, len1=arr1.length; i<len1; i++) {
        const flag = binarySearch(arr2, arr1[i]);
        if (flag && !obj[arr1[i]]) {
          obj[arr1[i]] = true;
          section.push(arr1[i]);
        }
      }
      return section;
    }
    console.log(section(arr1, arr2));
  </script>
</body>
</html>